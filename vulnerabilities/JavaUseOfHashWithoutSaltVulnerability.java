import java.util.ArrayList;
import java.util.List;

public class JavaUseOfHashWithoutSaltVulnerability implements Vulnerability {

	@Override
	public List<Integer> run(Analyzer ana) {
		
		ArrayList<Integer> lines = new ArrayList<>();
		JavaAnalyzer javaana=(JavaAnalyzer)ana;
		
		for (int i = 1; i <= javaana.getLineToLine().size(); i++) {
			String line = javaana.getLineToLine().get(i);
			System.out.println(line);
			if (line!=null) {
			line = line.toUpperCase();
			
			if (line.contains("HASH") && !line.startsWith("//")) {
				lines.add(i);
			}
		}

		}
		
		return lines;
	}
}
