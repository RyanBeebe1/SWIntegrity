import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

public class JavaUrlRedirectionVulnerability {
	
	public List<Integer> run(Analyzer ana){
		
		JavaAnalyzer javaAn = (JavaAnalyzer) ana;
		List<Integer> vulnLines = new ArrayList<>();
		String fileContents = javaAn.getFileContents().toLowerCase();
		String detect[] = {"import java.net.HttpURLConnection", "import java.net.URL", "new URL", "HttpURLConnection", "openConnection"};
		
		for(HashMap.Entry<Integer, String> e: javaAn.getLineToLine().entrySet())
		{
			for(String c: detect)
			{
				if(e.getValue().toString().contains(c))
				{
					vulnLines.add(e.getKey());
				}
			}
		}
		
		return vulnLines;
	}

}
