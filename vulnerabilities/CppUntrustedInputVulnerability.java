import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

public class CppUntrustedInputVulnerability implements Vulnerability {
    @Override
    public List<Integer> run(Analyzer ana) {
        CppAnalyzer cppana = (CppAnalyzer) ana;
        ArrayList<Integer> lines = new ArrayList<>();


        for (HashMap.Entry<Integer,String> e: cppana.getNumToLine().entrySet()) {
            if (e.getValue().contains("gethostbyaddr")) {
                lines.add(e.getKey());
            }
        }

        return lines;
    }
}
