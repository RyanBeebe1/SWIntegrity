import java.util.ArrayList;
import java.util.List;

public class CppDangerousFuncVulnerability implements Vulnerability {

	@Override
	public List<Integer> run(Analyzer ana) {
		ArrayList<Integer> lines = new ArrayList<>();
		CppAnalyzer cppana=(CppAnalyzer)ana;
		ArrayList<String> dangerous = new ArrayList<>();
		dangerous.add("memset");
		dangerous.add("gets");
		dangerous.add("scanf");
		dangerous.add("strcpy");
		dangerous.add("strcat");
		
		for (int i = 1; i <= cppana.getNumToLine().size(); i++) {
			String line = cppana.getNumToLine().get(i);
			
			for (int k = 0; k < dangerous.size(); k++) {
				if (line.contains(dangerous.get(k))) {
					lines.add(i);
				}
			}
		}
		
		
		return lines;
	}

}
