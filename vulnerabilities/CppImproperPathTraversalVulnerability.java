import java.util.ArrayList;
import java.util.List;

/**
 * @author Manoj
 * CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
 * Since we can't actually verify what input will be placed this will highlight that it is possible for attackers to take advantage of this code
 * and that statement will be printed within the report
 */
public class CppImproperPathTraversalVulnerability implements Vulnerability {
	
	public List<Integer> run(Analyzer ana){
		
		CppAnalyzer cppana = (CppAnalyzer) ana;
		ArrayList<Integer> lines = new ArrayList<>();
		
		for (int i = 1; i <= cppana.getNumToLine().size(); i++) {
			String line = cppana.getNumToLine().get(i);
			line = line.toUpperCase();
			
			if (line.contains("../") || line.contains("./")) {
				lines.add(i);
			}
			
			if(line.contains("path") || line.contains("Path"))
			{
				lines.add(i);
			}
			
			if(line.contains("open"))
			{
				lines.add(i);
			}
			

		}
		
		return lines;
		
	}

}
