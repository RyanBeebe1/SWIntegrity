import java.util.ArrayList;
import java.util.List;

public class CppRiskyCryptoVulnerability implements Vulnerability {

	@Override
	public List<Integer> run(Analyzer ana) {
		ArrayList<Integer> lines = new ArrayList<>();
		CppAnalyzer cppana=(CppAnalyzer)ana;
		ArrayList<String> dangerous = new ArrayList<>();
		dangerous.add("DES");
		dangerous.add("MD4");
		dangerous.add("MD5");
		dangerous.add("SHA1");
		dangerous.add("MD3");
		dangerous.add("MD2");
		dangerous.add("MD1");
		
		for (int i = 1; i <= cppana.getNumToLine().size(); i++) {
			String line = cppana.getNumToLine().get(i);
			
			for (int k = 0; k < dangerous.size(); k++) {
				if (line.contains(dangerous.get(k))) {
					lines.add(i);
				}
			}
		}
		
		return lines;
	}

}
